# Allowlisted tools for Kali OS Agent
# Each tool entry:
#   cmd: a shell command template rendered with {param} placeholders
#   active: true/false (true means intrusive; requires ALLOW_ACTIVE_SCAN=1)
#   timeout: seconds
#   artifacts: glob patterns (relative to job working directory) to upload back
tools:
  nmap_tcp_top_1000:
    cmd: "nmap -Pn --top-ports 1000 -T3 {target} -oN nmap_top1000.txt"
    active: true
    timeout: 7200
    artifacts: ["nmap_top1000.txt"]

  ffuf_dirb:
    cmd: "ffuf -u {url}/FUZZ -w {wordlist} -mc 200,204,301,302,307,401,403 -o ffuf.json -of json"
    active: true
    timeout: 3600
    artifacts: ["ffuf.json"]

  gobuster_dir:
    cmd: "gobuster dir -u {url} -w {wordlist} -t 50 -o gobuster.txt"
    active: true
    timeout: 3600
    artifacts: ["gobuster.txt"]

  sqlmap_basic:
    cmd: "sqlmap -u {url} --batch --risk=1 --level=1 --output-dir=."
    active: true
    timeout: 14400
    artifacts: ["output/*"]
