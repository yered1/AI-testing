# Allowlisted tools for the Kali OS agent
nmap_tcp_top_1000:
  cmd: "nmap -Pn --top-ports 1000 -T3 {{target}} -oN nmap_top1000.txt -oX nmap_top1000.xml"
  active: true
  timeout: 10800
  artifacts: ["nmap_top1000.*"]

ffuf_dirb:
  cmd: "ffuf -u {{url}}/FUZZ -w {{wordlist}} -o ffuf.json -of json"
  active: false
  timeout: 7200
  artifacts: ["ffuf.json"]

gobuster_dir:
  cmd: "gobuster dir -u {{url}} -w {{wordlist}} -o gobuster.txt"
  active: false
  timeout: 7200
  artifacts: ["gobuster.txt"]

sqlmap_basic:
  cmd: "sqlmap -u {{url}} --batch --output-dir=sqlmap_out"
  active: true
  timeout: 10800
  artifacts: ["sqlmap_out/**"]

# == merged from tools_extras/gobuster_ffuf_sqlmap.yaml ==
  gobuster_dns_safe:
    active: true
    timeout: 1200
    cmd: "gobuster dns -d {{domain}} -w {{wordlist|default:'/usr/share/seclists/Discovery/DNS/subdomains-top1million-5000.txt'}} -t {{threads|default:50}} -o gobuster_dns.txt"
    artifacts: ["gobuster_dns.txt"]
  ffuf_post_json:
    active: true
    timeout: 1800
    cmd: "ffuf -w {{wordlist|default:'/usr/share/seclists/Discovery/Web-Content/directory-list-2.3-medium.txt'}} -u {{url}} -X POST -H 'Content-Type: application/json' -d '{{body|default:\"{}\"}}' -mc {{status|default:'200,201,204'}} -o ffuf_post.json -of json"
    artifacts: ["ffuf_post.json"]
  sqlmap_smart:
    active: true
    timeout: 3600
    cmd: "sqlmap -u {{url}} --level {{level|default:2}} --risk {{risk|default:1}} --batch --random-agent --output-dir=sqlmap_out"
    artifacts: ["sqlmap_out/**"]

tools:
  gobuster_dns_safe:
    active: true
    cmd: >
      gobuster dns -d {{ domain }} -w {{ wordlist|default("/usr/share/wordlists/dns/subdomains-top1million-5000.txt") }}
      -t {{ threads|default(50) }} -o gobuster_dns.txt
    timeout: 7200
    artifacts:
      - gobuster_dns.txt

  ffuf_post_json:
    active: true
    cmd: >
      ffuf -u {{ url }} -X POST -H 'Content-Type: application/json'
      -d '{{ data|default("{}") }}'
      -w {{ wordlist|default("/usr/share/seclists/Discovery/Web-Content/common.txt") }}
      -mc {{ match_codes|default("200,204,302,401,403") }}
      -of json -o ffuf_post.json
    timeout: 7200
    artifacts:
      - ffuf_post.json

  sqlmap_smart:
    active: true
    cmd: >
      sqlmap -u {{ url }} --batch --smart --level {{ level|default(2) }}
      --output-dir=sqlmap_out
    timeout: 14400
    artifacts:
      - sqlmap_out/**
